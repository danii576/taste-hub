<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<link rel="stylesheet" href="https://unpkg.com/primeicons/primeicons.css" />
<div class="topbar">
  <div class="logo">
    <button (click)="pageLogoClick()" class="logo-button">
      <img style="width:45px;" src="assets/site-images/favicon.jpg" alt="Logo" />
    </button>
  </div>

  <div class="menu">
    <button (click)="themeClick()">
      <i [class]="isDarkMode ? 'pi pi-moon' : 'pi pi-sun'"></i> {{ 'TOPBAR.MODE' | translate }}

    </button>

    <button (click)="homeClick()" [ngClass]="{ active: currentRoute === '/home' }">
      <i class="pi pi-home"></i> {{ 'TOPBAR.HOME' | translate }}

    </button>

    <button (click)="MenuClick()" [ngClass]="{ active: currentRoute === '/menu' }">
      <i class="pi pi-bars"></i> {{ 'TOPBAR.MENU' | translate }}

    </button>

    <button (click)="aboutClick()" [ngClass]="{ active: currentRoute === '/about' }">
      <i class="pi pi-info-circle"></i> {{ 'TOPBAR.ABOUT' | translate }}

    </button>

    <button (click)="timingClick()" [ngClass]="{ active: currentRoute === '/timing' }">
      <i class="pi pi-clock"></i> {{ 'TOPBAR.TIMING' | translate }}

    </button>

    <button (click)="contactClick()" [ngClass]="{ active: currentRoute === '/contact' }">
      <i class="pi pi-phone"></i> {{ 'TOPBAR.CONTACT' | translate }}

    </button>
    <!-- Show both buttons, highlight the active one -->
    <button (click)="toggleLang()" style="display: flex; align-items: center; gap: 6px;">
      <img [src]="currentLang === 'pt' ? 'assets/Flag/flag-PT.png' : 'assets/Flag/flag-EN.png'" alt="Language Flag"
        style="width: 22px; height: 18px;" />
      {{ currentLang === 'pt' ? 'PT' : 'EN' }}
    </button>

    <li *ngIf="loggedUser" class="profile-container">
      <div class="profile-toggle" (click)="toggleProfileDropdown()">
        <span class="glyphicon glyphicon-user"></span> {{ loggedUser.name }} â–¼
      </div>

      <!-- Show dropdown only if profile dropdown open and logout confirm NOT showing -->
      <div style="color: blue;" *ngIf="showProfileDropdown && !showLogoutConfirm" class="profile-dropdown">
        <p><span style="color: blue;" class="icon">ðŸ‘¤</span> <strong>{{ loggedUser.name }}</strong></p>
        <p><span style="color: blue;" class="icon">ðŸ“§</span> {{ loggedUser.email }}</p>

        <a href="#" style="color: blue; display: block; margin-top: 12px;"
          (click)="showLogoutConfirm = true; $event.preventDefault()">
          <span class="glyphicon glyphicon-log-in"></span> {{ 'TOPBAR.PROFILE.LOGOUT' | translate }}
        </a>
      </div>

      <!-- Show only logout confirmation popup when confirm active -->
      <div *ngIf="showProfileDropdown && showLogoutConfirm" class="confirm-popup"
        style="position: absolute; top: 100%; right: 0; width: 220px; margin-top: 8px;">
        <p style="color: blue;">{{ 'TOPBAR.PROFILE.CONFIRM_LOGOUT' | translate }}</p>
        <div class="confirm-popup-buttons">
          <button style="color: blue;" class="cancel-btn" (click)="cancelLogout()"> {{ 'TOPBAR.PROFILE.CANCEL' |
            translate }}
          </button>
          <button style="color: red;" class="ok-btn" (click)="confirmLogout()"> {{ 'TOPBAR.PROFILE.CONFIRM' | translate
            }}
          </button>
        </div>
      </div>
    </li>
  </div>
</div>